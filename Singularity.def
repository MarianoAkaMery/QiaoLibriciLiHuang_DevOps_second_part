Bootstrap: docker

Stage: builder
From: ubuntu:24.04
%post
  set -eux
  apt-get update && apt-get install -y --no-install-recommends \
        build-essential cmake
  cd /opt/src && ./build.sh            # your existing script
  apt-get purge -y build-essential cmake
  apt-get autoremove -y
  apt-get clean && rm -rf /var/lib/apt/lists/* /var/cache/apt/archives/*
%environment
  PATH=/opt/app/build:$PATH
%labels
  Maintainer="you@example.com"

Stage: runtime
From: ubuntu:24.04
%files from builder /opt/app/build /opt/app/
%post
  set -eux
  apt-get update && apt-get install -y --no-install-recommends libstdc++6
  apt-get clean && rm -rf /var/lib/apt/lists/*
%runscript
  exec /opt/app/build/convert_grayscale "$@"
